{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"The Pytest Cookbook - recipes with videos and repos","text":""},{"location":"#purpose_of_this_book","title":"Purpose of this book","text":"<ol> <li> <p>To provide a number of ready built and congfigurable FULL STACK PYTHON TEST FRAMEWORK, (PFS), comprising of over 200 highly commented test templates for developers to adapt to their own needs along with resource links that have helped me greatly, as well as integration of these into the frameworks.</p> </li> <li> <p>To provide a curated source of articles and videos that surround PyTest, for example Docker, that enable 'out of the box' ease of use. Some are created by me, others reference with acknowledgments other sources.</p> </li> </ol>"},{"location":"#pytest_full_stack_pfs","title":"PyTest Full Stack, (PFS)","text":"<p>The PyTest Full Stack suite has an installation tat will just require a 1-2-3 of:</p> <ol> <li><code>pip install -r requirements.txt</code>.</li> <li><code>playwright install</code> to load Playwright browsers.</li> <li><code>python -m pytest -v</code> to run over 200 tests.</li> </ol> <p>PFS uses a number of PyTest hooks for utilities and features.</p> <p>One of these is customising the terminal report and one can configure the output in a number of ways, explained in articles and videos.</p> <p>Here is a sample output:</p>"},{"location":"#custom_header_sections","title":"Custom header sections","text":""},{"location":"#customised_words_colours_and_icons","title":"Customised words, colours and icons","text":""},{"location":"#custom_footer_sections","title":"Custom footer sections","text":"<p>The frameworks have logging and other utilities installed to provide a complete framework.</p> <p>Resources included are:</p> <ol> <li>Links to helpful articles, videos and documentation. </li> <li>Converted and transcribed code of great YT videos where there is no code repo.</li> </ol>"},{"location":"#test_frameworks","title":"Test frameworks","text":"<p>See the README.md in root of each Test framework for detailed and up to date set up instructions.</p> <p>There are two main test frameworks:</p> <ul> <li>PyTest_01_Full - a full stack testing framework from SQL Schemas to E2E testing with Playwright</li> <li>PyTest_02_DJANGO - is its own unique testing framework built from a range of sources. (Under construction and will be a PyTest-Full-Stack test suite for Django).</li> </ul> <p>I strive to acknowledge sources I have used to learn PyTest and any adaptations of code samples used therein.</p> <p>As a curated list of resources, I have integrity over linking to the work of others and due credits are given.</p> <p>Often I am a wrapper around someone else's effort and I try to add a different presentation whre possible, as we often find our understanding with a different presentation of the subject. Hence having may teachers enables us all as eternal students to get our heads around sometimes very complex subjects.</p>"},{"location":"#about_me","title":"About me","text":"<p>I am a Python Test Engineer using PyTest and Playwright as well as a Software Tester and Django developer.</p> <p>I enjoy building Plugins and I have created a PyTest Hooks and Plugin online video course that teaches how to create lite versions of some well known plugins as well as our own useful custom plugins which can be made distributabe:</p> <p>Example plugins are:</p> <ul> <li>CSV Lite Reporter</li> <li>Export results to DB</li> <li>Sorting, randomizing and deselecting tests</li> <li>Customising the console report with colors and icons</li> </ul> <p>The course is available Udemy Hooks and Plugins course and Udemy has a sale every two weeks and the cost would be $20 USD approx.</p> <p></p> <p>There is more information about me and my services here.</p>"},{"location":"#how_best_to_use_this_book","title":"How best to use this book","text":"<p>For the PyTest-Full-Stack framework:</p> <p>Download or git clone from repo.</p> <p>Follow installation instructions in the README.md or the 1-2-3 of:</p> <ol> <li><code>pip install -r requirements.txt</code>.</li> <li><code>playwright install</code> to load Playwright browsers.</li> <li><code>python -m pytest -v</code> to run over 200 tests.</li> </ol> <p>For prettier general console output, Rich and PyBoxen, built on Rich, are used.</p> <p><code>pytest-sugar</code>, an excellent plugin, was used but with the inclusion of the pytest_terminal_summary hook in the conftest.py file of PyTest-Full-Stack, we have a coloruful and decorative console output that is configurable and customisable (see YouTube guide below).</p>"},{"location":"#youtube_videos","title":"YouTube Videos","text":"<p>I have made some videos to assist in using this book.</p> <p>These are available here.</p> <p></p>"},{"location":"learn/","title":"Learning PyTest - Suggested path","text":"<p>I have made some videos to assist in using this PyTest Cookbook and how to customise the hooks and plugins used to create custom terminal reports and custom CSV files.</p> <p>These videos are available here.</p>"},{"location":"learn/#1_coffeebeforearch","title":"1. CoffeeBeforeArch","text":"<p>Located in <code>02_py_coffee</code> in PFS, this is a great video series on PyTest. I have included the tests form his repo as part of the template tests. Links in repo.</p> <p>CoffeeBeforeArch</p>"},{"location":"learn/#2_indian_pythonista","title":"2. Indian Pythonista","text":"<p>Located in <code>03_indian_pythonista</code> in PFS, this is another great video series that has source code included.</p> <p>Indian Pythonista</p>"},{"location":"learn/#3_pytest_with_eric","title":"3. PyTest with Eric","text":"<p>This is perhaps one of the best resources for PyTest, PyTestWithEric, I am creating videos of them and incorporating the GitHub code to provide a second content delivery medium, explaining salient points.</p> <p>This is both for my own technical development and a way of creating a greater audience for this body of work.</p> <p>I have started recording videos of me go through the article and adding them to PyTest Full Stack in 60_pwe.</p> <p>Playlist PyTest With Eric</p> <p>Articles videod:</p> <ul> <li>01 pytest-html</li> <li>02 suppress warnings</li> <li>03 read yaml files with argparse and typer and test</li> <li>04 transactions with SQL Model</li> <li>05 setting up allure reporting</li> <li>06 automated testing with GitHub actions</li> </ul>"},{"location":"learn/#4_hooks_and_plugins","title":"4. Hooks and Plugins","text":"<p>For an advanced look at these topics, I have my course hosted on Udemy:</p> <p>The course is available Udemy Hooks and Plugins course and Udemy has a sale ever two weeks and the cost would be $20 USD approx.</p> <p></p>"},{"location":"asides/asides/","title":"Asides","text":""},{"location":"asides/asides/#what_are_asides","title":"What are asides?","text":"<p>Asides are articles on useful aspects of PyTest Full Stack but are not part of a PyTest Full Stack Run.</p> <p>For example, we have a folder <code>docker</code> that is integrated into PFS, but we also have an isolated set of docker tests that would need to be run in a separate and isolated environment with elements of PFS added in. </p> <p>Essentially the converse of what we are doing in PFS.</p> <p>An example is tests/_isolated_suites which has a docker-postgres-fixtup suite.</p>"},{"location":"asides/asides/#pluggy","title":"Pluggy","text":"<p>Pytest uses Pluggy to have a plugin architecture.</p> <p>Using Pluggy docs, I have created a repo andd video of the examples in the docs as well as extend it to include two plugins rather than just one.</p>"},{"location":"asides/asides/#mocking","title":"Mocking","text":"<p>This covers mock, patch and monkeypatch using Rich and PyBoxed for pretty console output. We look at globals() and sys.modules to see what is happening under the hood as well as create our own mocks to better understand this topic.</p> <p></p>"},{"location":"asides/mocking/","title":"Python Mock, Patch and Monkeypatch","text":""},{"location":"asides/mocking/#about","title":"About","text":"<p>I have created a repo and video series to dive deeper into what mock, patch and monkeypatch do behind the scenes.</p> <p>Using Rich and PyBoxen for pretty console output, we look at globals() and sys.modules to see how we can create our own mocks and patches.</p> <p>We will also look at the source code for <code>mock.py</code> as well as look at a number of template examples that I have collected from various named sources.</p> <p>The hardest part is 'getting' the wiring so it is best to work with the repo and break and fix the tests to really understand that patching involves using `where it is called, not where it is defined'.</p> <p>Regardless, these act as templates and with use the wiring will become clearer.</p> <p>The repo is here and the YT video series is here with the remaining videos uploaded by the end of JUL2024.</p> <p></p> <p>I have endeavoured to make the repo heavily commented so that it can be used as an 'ebook'.</p> <p></p>"},{"location":"asides/pluggy/","title":"Pluggy","text":""},{"location":"asides/pluggy/#about","title":"About","text":"<p>Pluggy as per docs:</p> <ul> <li> <p>pluggy is the crystallized core of plugin management and hook calling for pytest. It enables 1400+ plugins to extend and customize pytest\u2019s default behaviour. Even pytest itself is composed as a set of pluggy plugins which are invoked in sequence according to a well defined set of protocols.</p> </li> <li> <p>It gives users the ability to extend or modify the behaviour of a host program by installing a plugin for that program. The plugin code will run as part of normal program execution, changing or enhancing certain aspects of it.</p> </li> <li> <p>In essence, pluggy enables function hooking so you can build \u201cpluggable\u201d systems.</p> </li> </ul> <p>I have uploaded a video and repo where I have encoded the 'complete example' in the docs and added a second plugin so that the host can be run with two plugins extending its functionality.</p>"},{"location":"asides/pluggy/#repo","title":"Repo","text":"<p>A tested project is available here: GiHub</p>"},{"location":"asides/pluggy/#yt_video","title":"YT Video","text":"<p>There is an explainer video (7mins) to walk through installation and running: YouTube</p> <p></p>"},{"location":"blog/","title":"Blog","text":""},{"location":"craig/contact/","title":"Contact me","text":"<p>Email: iwswordpress@gmail.com</p> <p>LinkedIn: Craig West</p>"},{"location":"craig/courses/","title":"Online courses","text":""},{"location":"craig/courses/#udemycom","title":"Udemy.com","text":"<p>The course Udemy Hooks and Plugins course has just been published and Udemy has a sale ever two weeks and the cost would be $20 USD approx.</p> <p></p> <p>I am currently developing two courses:</p> <ul> <li>Python - mock, patch and monkeypatch.</li> <li>PyTest Django Full Stack - a DB &lt;-&gt; E2E testing of a generic ecommerce store.</li> </ul> <p>The aim is to make them generic, ready to go templates, that also dive deeper into aspects of Python.</p> <p>I am of the opinion that as developers we do not need to reinvent the wheel - it has (almost) all been done before - and that we should be free to use our creativity to build great proucts.</p> <p>The type of course I would want...</p> <p></p>"},{"location":"craig/cv/","title":"CV","text":"<ul> <li> <p>PythonTestEngineer.co.uk</p> </li> <li> <p>Github CV</p> </li> </ul> <p></p> Python Test Engineer - particulalry Django"},{"location":"craig/cv/#python_test_engineer","title":"Python Test Engineer","text":"<ul> <li>Degree in Chemistry, Oxford University.</li> <li>Former A+ PC Technician, Microsoft Certified Systems Engineer and Microsoft Certified SQL Server DBA.</li> <li>Former Business Information Architect.</li> <li>Qualified Accountant Technician and business owner.</li> <li>Experience with REST APIs, GraphQL, React, Vue, Web Components, Node, Docker</li> <li>Talks and workshops given at WordCamps, MeetUps and NDC.</li> </ul>"},{"location":"craig/cv/#talks_and_workshops","title":"Talks and Workshops","text":"<p>A list of talks and workshops I have given: </p> <ul> <li> <p>TALK: Offline and instant websites, aka Progressive Web Apps - AsyncJS, Brighton, September 2021.</p> </li> <li> <p>LIGHTNING TALK: WordPress as a Micro Service to any framework - WordFest, July 2021.</p> </li> <li> <p>TALK: WP REST API and Web Components =&gt; 100% Internet - WordCamp Santa Clarita, July 2021.</p> </li> <li> <p>TALK: Web Components in WP, Gutenberg and as HTML plugins. - WordCamp North East Ohio May 2021.</p> </li> <li> <p>TALK: Leveraging the power or the WordPress REST API - WP Leeds April 2021</p> </li> <li> <p>WORKSHOP: WP REST API and you -&gt; Best Friends Forever workshop (90 mins) - WordCamp Greece April 2021 </p> </li> <li> <p>TALK: Web Components as Micro Apps - NDC London, Jan 2021</p> </li> <li> <p>TALK: Unifying frameworks with Web Components - Brighton AsyncJS, Nov 2020</p> </li> <li> <p>WORKSHOP: Progressive Web Apps Workshop (2hrs) - NDC Oslo June 2020 and a paid training workshop with NDC</p> </li> <li> <p>WORKSHOP: Web Components Workshop (2hrs) - NDC Oslo June 2020 and a paid training workshope with NDC</p> </li> <li> <p>WORKSHOP: Progressive Web Apps Workshop (2hrs) - Brighton WordUp June 2020</p> </li> <li> <p>WORKSHOP: WordPress REST API with AJAX Forms and Pages - WordCamp Denver, June 2020.</p> </li> <li> <p>WORKSHOP: WordPress REST API with AJAX Forms and Pages - WordCamp Kent, Ohio May 2020.</p> </li> <li> <p>TALK: What is the WP REST API and how can I use it to make forms and pages that don\u2019t need to do be reloaded? - WordUp Brighton May 2020.</p> </li> <li> <p>WORKSHOP: WordPress REST API and AJAX Forms - WordCamp Geneva March 2020 EVENT CANCELLED due to virus concerns </p> </li> <li> <p>TALK - WP-HTML: The marriage of WP and JS Frameworks for expansion, ubiquity and profit - WordCamp Vienna February 2020.</p> </li> <li> <p>WORKSHOP: WordPress REST API - WordCamp Vienna February 2020.</p> </li> <li> <p>TALK: Progressive Web Apps - Brighton WordUp November 2019.</p> </li> <li> <p>TALK: Decoupled WordPress (code along style) - WordCamp Dublin October 2019.</p> </li> <li> <p>TALK: JWT and Authentication - WPHooked London September 2019</p> </li> <li> <p>TALK: Decoupled WordPress and WP Components - WordCamp Brighton August 2019.</p> </li> </ul>"},{"location":"craig/cv/#published_udemy_courses","title":"Published Udemy Courses","text":"<p>Udemy is a great learning platform and having sales at least once a month, courses can be purchased for ~ \u00a315/$15 USD.</p> <p>These have now been retired.</p> <ul> <li>WordPress REST API and AJAX Forms/Pages - DEMO https://www.youtube.com/watch?v=eubhbcGH_Ws&amp;t=6s (paid)</li> <li>Progressive Web Apps - DEMO https://www.youtube.com/watch?v=k_lHvNL0gkw (paid)</li> <li>WP-HTML: decoupling WordPress to any HTML platform using Web Components and the WP REST API. This also enables HTML plugins for non-WP Sites - https://www.udemy.com/course/powerful-html-pages-using-wordpress-component-architecture/ (free)</li> <li>Stylish Dynamic Web Forms with jQuery validation - https://www.udemy.com/course/ready-to-use-form-validation-templates-with-jquery/ (free)</li> </ul>"},{"location":"craig/cv/#youtube_courses_-_developer_to_developer_courses","title":"YouTube Courses - Developer to Developer courses","text":"<p>These are video courses that cover work through official documents to help other developers, learn in public and show prosepective employers not just what I know but how I learn and how I communicate technical matters to others.</p> <p>There are also some specific videos explaining solutions to set ups other developers may encounter.</p> <ul> <li> <p>HIGHLY-FUNCTIONAL-WEBCOMPONENTS: A video course based on the workshop I gave at NDC Oslo June 2020 - https://www.youtube.com/watch?v=QC-JTqQTv2k&amp;list=PLsszRSbzjyvkQwzrJobroRl7z7MfSlePa </p> </li> <li> <p>WP Plugin Boilerplate:  I havea video series to explain WP Plugin Boilerplate using a scaffolded out project that demonstrates the use of MySQL, wp_nonce, REST API, forms and how to redirect pages to plugin templates to make the plugin theme independent. https://www.youtube.com/watch?v=lJ9ktD4JOfs&amp;list=PLsszRSbzjyvn-RQr4dEjrgnTne2HcJKee</p> </li> </ul>"},{"location":"craig/cv/#volounteering","title":"Volounteering","text":"<p>I volounteer at Codebar.io in Brighton as well as some Community Kitchens.</p>"},{"location":"craig/cv/#outside_interests","title":"Outside interests","text":"<p>These include Community Kitchens, gym, occasional partner dancing and DIY.</p> <p></p>"},{"location":"craig/services/","title":"Services provided","text":""},{"location":"craig/services/#skillset","title":"Skillset","text":"<p>Primarily:</p> <ul> <li>Python</li> <li>PyTest</li> <li>Playwright</li> <li>Django</li> </ul> <p>Tools:</p> <p>I strive to dive deeper into these tools and see them as programming languages in their own right. DevOps seems to be an essential part of my work:</p> <ul> <li>Shell Scripting</li> <li>Git/GitHub Actions</li> <li>Docker</li> </ul>"},{"location":"craig/services/#engagement_style","title":"Engagement Style","text":"<p>I offer on-demand, freelance services starting from 1/2 day blocks.</p> <p>As and when you need it...</p> <p>Tech is a way of life for me not just a job and I strive to have enthusiasm and passion for the projects I work on. Professional fulfilment is paramount.</p>"},{"location":"craig/services/#eligibility","title":"Eligibility","text":"<ul> <li>UK National</li> <li>Fluent English</li> </ul>"},{"location":"craig/services/#on-sitehybrid","title":"On-site/Hybrid","text":"<p>I am based in Brighton and enjoy (local) on-site work as well as working from my home office.</p>"},{"location":"craig/services/#volunteer_coach","title":"Volunteer Coach","text":"<p>I am a volunteer coach with Codebar Brighton.</p>"},{"location":"craig/services/#youtube","title":"YouTube","text":"<p>I produce a large amount of content that is associated with a repo that enables 'out of the box' ease of use.</p> <p>If I find good videos without a repo, I often create a repo and my own video with reference to the source video. I have no commercial interest in this matter.</p> <p>My YouTube Channel</p>"},{"location":"craig/services/#outside_of_tech","title":"Outside of tech...","text":"<p>I enjoy working in community kitchens and love laughter, creating, doing and trying to work out why things are funny.</p> <p></p>"},{"location":"django_testing/","title":"PyTest Django Full Stack","text":"<p>I have decided to produce a book or technical manual on Full Stack Django Testing, with a companion video course.</p> <p>This will be in its own site and the link will be added here in due course.</p>"},{"location":"docker/docker_flask_pdb/","title":"Multiple container testing","text":"<p>This is inspired by the excellent courst 'Python in Containers' on Udemy.</p> <p>We build a flask image and this is used as one layer for another image for testing.</p> <p>An explainer video is here: YouTube Video.</p> <p>The repo is here.</p> <p>It introduces the use of Docker's ARG, where we can specify at build time another image. </p> <p>Generally, nothing can come before FROM as this creates a new shell as it were.</p> <p>However, we can use ARG to be able to pass in arguments in the CLI build:</p>"},{"location":"docker/docker_flask_pdb/#base_image","title":"Base Image","text":"<pre><code>ARG BaseImage\nFROM $BaseImage\n</code></pre>"},{"location":"docker/docker_flask_pdb/#use_--build-arg","title":"use --build-arg","text":"<pre><code>docker build -t factors_flask_tester -f Dockerfile.tester --build-arg BaseImage=factors_flask_pdb .\n</code></pre> <p>Tests are carried out on the <code>factors_flask_tester</code> image.</p> <p>Note, we can use the -f flag to select a Dockerfile. This can be a convenience when we have several Dockerfiles we want to use but don't want to have to overwrite the root Dockerfile.###</p>"},{"location":"docker/docker_index/","title":"Docker","text":"<p>Docker seems to be an essential part of testing work.</p> <p>As a result, I have a dedicated section for Docker apps.</p>"},{"location":"docker/docker_postgres_setup/","title":"Docker Postgress PgAdmin Adminer","text":"<p>This uses my Postgres image that has the VectorDB extension installed, (for semantic search).</p> <p>It has both PgAdmin and Adminer as Postgress clients.</p> <p>There are range of SQL Crud files included so that you have Python-Docker-Postgres working.</p> <p>I had some issues with this type of set up but came up with my own docker-compose file.</p> <p>YouTube Video</p> <p>The repo is here: GitHub</p> <p>There are a number of ways to set up a volume.</p> <p>For me, the following saved the Postgres data:</p> <pre><code>volumes:\n   - ./db-data/:/var/lib/postgresql/data/\n</code></pre> <p>and it uses the default storage location for data in Postgres.</p> <p>Using the named volume approach gave me a few issues.</p> <p></p>"},{"location":"docker/docker_to_go/","title":"Docker To Go","text":"<p>I have a range of Docker multi-container apps and the repo is here.</p> <p>I will be adding more notes in the repo and a video explainer shortly...</p>"},{"location":"docker/docker_to_go/#django","title":"Django","text":""},{"location":"docker/docker_to_go/#django_celery","title":"Django Celery","text":""},{"location":"docker/docker_to_go/#entrypoint-cmd","title":"Entrypoint-CMD","text":""},{"location":"docker/docker_to_go/#fastapi","title":"FastAPI","text":""},{"location":"docker/docker_to_go/#flask-redis","title":"Flask-Redis","text":""},{"location":"docker/docker_to_go/#nginx-flask-mysql","title":"Nginx-Flask-MySQL","text":""},{"location":"docker/docker_to_go/#python-postgres-pgadmin-adminer","title":"Python-Postgres-PgAdmin-Adminer","text":""},{"location":"docker/pytest_docker_plugin/","title":"PyTest and Docker","text":"<p>Docker seems to be an essential part of testing work.</p> <p>As a result, I have a section on Docker, with a sub section of Docker To Go, a range of ready made Docker set ups. Docker</p> <p>I have done many trainings on Docker and I would say the best training is on my favourite platform Udemy: Docker Bootcamp: Conquer Docker with Real-World Projects</p> <p>Sales every two weeks or so will mean you can get if for $20 USD or so. </p> <p>What I really like about this course is it does not really go into theory but just builds a great number of microservices and connects them. Repetition makes it become part of the muscle and is probably what is needed for a Test Engineer.</p> <p>There are other courses that go deeper and one that I find really good is: Python in Containers</p>"},{"location":"docker/pytest_docker_plugin/#docker_and_pytest_full_stack","title":"Docker and PyTest Full Stack","text":"<p>PyTest-Full-Stack has one example using <code>pytest-docker</code>.</p> <p>Ensure docker desktop or equivalent is running! \ud83d\ude2c </p> <p>Located in tests/docker. My usual folder naming of 70_docker is unacceptable so I just use docker.</p> <p>There is a YT video of this: pytest-docker</p> <p></p>"},{"location":"pytest/","title":"PyTest Full Stack","text":""},{"location":"pytest/#full_stack","title":"Full Stack","text":"<p>This framework has tests covering:</p> <ul> <li>SQL Schemas for foreign keys, number of tables, check constraints etc...</li> <li>Unit tests</li> <li>Integrations tests</li> <li>Mock, patch and monkeypatch templates</li> <li>Behavior Driven Testing templates</li> <li>API testing</li> <li>End to End testing with Playwright</li> </ul>"},{"location":"pytest/#youtube_videos","title":"YouTube videos","text":"<p>Videos are available here: YouTube </p>"},{"location":"pytest/#repo","title":"Repo","text":"<p>The PyTest Full Stack repo is available here: PyTest Full Stack</p>"},{"location":"pytest/#installation","title":"Installation","text":"<ul> <li>In your IDE open up the PyTest_01_FULL folder.</li> <li>Create a virtual environment <code>python -m venv venv</code>.</li> <li>Activate your virtual enviromnent: Windows <code>.\\venv\\Scripts\\activte</code> or Mac <code>source venv\\bin\\activate</code>.</li> <li>install requirements <code>pip install -r requirements.txt</code>.</li> <li>for Playwright browsers run <code>playwright install</code>.</li> <li>run all tests <code>python -m pytest -vs</code>.</li> <li>There are around 200 templated tests.</li> <li>The video series goes into features and utils -&gt; YouTube</li> </ul>"},{"location":"pytest/pytest_allure/","title":"Allure Reporting - Windows","text":"<p>This has not been installed in PyTest-Full-Stack but a fine article, as ever, is https://pytest-with-eric.com/reporting/pytest-allure-report/.</p> <p>You will need Allure to run this repo and Java needs to be installed.</p> <p>If you are on Windows, like me, we can set up Java/Allure as follows:</p> <p>I used the following video:</p> <p>Useful JDK Video</p> <p>My video is here:</p> <p>Install Java</p> <p>To install Allure: </p> <p>Allure Install</p> <ul> <li>For Allure, download the zip of the version you want.</li> <li>Unzip and place in a location of your choice.</li> <li>Add the path in environment variables. Mine was C:\\allure\\bin</li> </ul>"},{"location":"pytest/pytest_cheat_sheet/","title":"PyTest Cheatsheet","text":""},{"location":"pytest/pytest_cheat_sheet/#source","title":"Source","text":"<p>https://gist.github./comkwmiebach/3fd49612ef7a52b5ce3a</p> <p>I have made some amendments to original version</p>"},{"location":"pytest/pytest_cheat_sheet/#usage","title":"Usage","text":"<p>(Create a symlink pytest for py.test)</p> <pre><code>pytest [options] [file_or_dir] [file_or_dir] ...\n</code></pre> <p>Help:</p> <pre><code>pytest --help|zless\n</code></pre>"},{"location":"pytest/pytest_cheat_sheet/#some_options","title":"Some options","text":"<pre><code> -s                    Show Output, do not caputure\n -x                    Stop after first failure\n -k \"expression\"       Only run tests that match expession (and fixtures)\n -rs                   Show extra summary info for SKIPPED\n -r chars              Show extra test summary info as specified by chars:\n                       (f)ailed, (E)error, (s)skipped, (x)failed, (X)passed\n                       (w)pytest-warnings (p)passed, (P)passed with output,\n                       (a)all except pP.\n\n -v                    Verbose\n -q, --quiet           Less verbose\n\n -l, --showlocals      Show local variables in tracebacks\n</code></pre>"},{"location":"pytest/pytest_cheat_sheet/#shorter_tracebacks_python_tracebacks","title":"Shorter tracebacks, python tracebacks","text":"<pre><code>pytest --tb=short\npytest --tb=line # even shorter\n</code></pre> <p>Use the Python standard traceback formatting:</p> <pre><code>pytest --tb=native\n</code></pre>"},{"location":"pytest/pytest_cheat_sheet/#output_capturing","title":"Output capturing","text":"<pre><code>pytest -s # disable all capturing\n</code></pre> <p>https://pytest.org/latest/capture.html#capturing-of-the-stdout-stderr-output</p>"},{"location":"pytest/pytest_cheat_sheet/#print_a_message_after_the_test","title":"Print a message after the test","text":"<p>The text is printed always, even in silent mode. See https://stackoverflow.com/a/38806934/362951</p> <pre><code>def report():\n  print(\"\"\"This is printed AFTER the test\"\"\")\nimport atexit\natexit.register(report)\n</code></pre>"},{"location":"pytest/pytest_cheat_sheet/#collect_information_test_suite_dry_run","title":"Collect information test suite / dry run","text":"<pre><code>py.test test_sample.py --collect-only\n</code></pre> <p>(will not display fixture code but fixture code will be run always)</p>"},{"location":"pytest/pytest_cheat_sheet/#output_verbose_messages","title":"Output verbose messages","text":"<pre><code>py.test test_sample.py -v\n</code></pre>"},{"location":"pytest/pytest_cheat_sheet/#run_a_single_test_specify_filepyclassname_like_so","title":"Run a single test: specify file.py::ClassName, like so","text":"<pre><code>py.test -q -s test_file.py::ClassName\n</code></pre> <p>(fixture code will also run)</p>"},{"location":"pytest/pytest_cheat_sheet/#ignore_exclude_certain_files_or_directories","title":"Ignore / exclude certain files or directories","text":"<pre><code>--ignore=lib/foo/bar.py --ignore=lib/hello/\n</code></pre>"},{"location":"pytest/pytest_cheat_sheet/#call_pytest_through_python","title":"Call pytest through python","text":"<pre><code>python -m pytest -q test_sample.py\n</code></pre>"},{"location":"pytest/pytest_cheat_sheet/#call_pytest_from_python","title":"Call pytest from python","text":"<p>Calling pytest programaticaly / from code:</p> <pre><code>import pytest\n# put all arguments into a string. example:\npytest.main(\"g/src/app/art/__init_unit.py\")    \n# another example:\npytest.main(\"-x mytestdir\")\n# or pass in a list of arguments:\npytest.main(['-x', 'mytestdir'])\n</code></pre>"},{"location":"pytest/pytest_cheat_sheet/#show_available_markers","title":"Show available markers","text":"<pre><code>py.test --markers\n</code></pre>"},{"location":"pytest/pytest_cheat_sheet/#create_a_reusable_marker","title":"Create a reusable marker","text":"<p>content of pytest.ini:</p> <pre><code>[pytest]\nmarkers =\n   webtest: mark a test as a webtest.\n</code></pre>"},{"location":"pytest/pytest_cheat_sheet/#only_run_tests_with_names_that_match_the_string_expression","title":"Only run tests with names that match the \"string expression\"","text":"<pre><code>py.test -k \"TestClass and not test_one\"\n</code></pre> <p>(fixture code will also run)</p>"},{"location":"pytest/pytest_cheat_sheet/#only_run_tests_that_match_the_node_id","title":"Only run tests that match the node ID","text":"<pre><code>py.test test_server.py::TestClass::test_method\n</code></pre> <p>(fixture code will also run)</p>"},{"location":"pytest/pytest_cheat_sheet/#stop_after","title":"Stop after","text":"<pre><code>py.test -x  # stop after first failure\n\npy.test --maxfail=2  # stop after two failures\n\npy.test --maxfail=2 -rf  # exit after 2 failures, report fail info.\n</code></pre>"},{"location":"pytest/pytest_cheat_sheet/#show_local_variables_in_tracebacks","title":"Show local variables in tracebacks","text":"<pre><code>py.test --showlocals \npy.test -l  # (shortcut)\n\npy.test --tb=long  # the default informative traceback formatting\npy.test --tb=native  # the Python standard library formatting\npy.test --tb=short  # a shorter traceback format\npy.test --tb=line  # only one line per failure\npy.test --tb=no  # no tracebak output\n</code></pre>"},{"location":"pytest/pytest_cheat_sheet/#drop_to_pdb_on_first_failure","title":"Drop to PDB on first failure","text":"<p>(then end test session)</p> <pre><code>py.test -x --pdb\n</code></pre>"},{"location":"pytest/pytest_cheat_sheet/#list_of_the_slowest_10_test_durations","title":"List of the slowest 10 test durations.","text":"<pre><code>py.test --durations=10\n</code></pre>"},{"location":"pytest/pytest_cheat_sheet/#send_tests_to_multiple_cpus","title":"Send tests to multiple CPUs","text":"<pre><code>py.test -n 4\n</code></pre>"},{"location":"pytest/pytest_cheat_sheet/#run_tests_with_decorator_slowest","title":"Run tests with decorator \"slowest\"","text":"<p>Run tests with decorator @pytest.mark.slowest or slowest = pytest.mark.slowest; @slowest</p> <pre><code>py.test -m slowest\n</code></pre>"},{"location":"pytest/pytest_cheat_sheet/#show_active_plugins","title":"Show active plugins","text":"<p>Find out which plugins are active in your environment</p> <pre><code>py.test --traceconfig\n</code></pre>"},{"location":"pytest/pytest_cheat_sheet/#instafail","title":"Instafail","text":"<p>if pytest-instafail is installed, show errors and failures instantly instead of waiting until the end of test suite:</p> <pre><code>py.test --instafail\n</code></pre>"},{"location":"pytest/pytest_cheat_sheet/#expected_exceptions","title":"Expected exceptions","text":"<p>See https://pytest.org/latest/assert.html#assertions-about-expected-exceptions</p> <p>Example:</p> <pre><code>def test_recursion_depth():\n    with pytest.raises(RuntimeError) as excinfo:\n        def f():\n            f()\n        f()\n    assert 'maximum recursion' in str(excinfo.value)\n</code></pre> <p>More usage examples: http://stackoverflow.com/a/15152283/362951</p> <p>Excinfo is a py.code.ExceptionInfo instance: http://pylib.readthedocs.org/en/latest/code.html#py-code-exceptioninfo</p> <p>Its main attributes are type (the exception class), value (the current instance), and traceback (see http://pylib.readthedocs.org/en/latest/code.html#py.code.Traceback) - </p> <p>Also see https://docs.python.org/3.4/library/sys.html#sys.exc_info</p>"},{"location":"pytest/pytest_cheat_sheet/#skip","title":"Skip","text":"<p>Simple use:</p> <p><pre><code>import pytest\npytest.skip(\"Skipping for some reason\")\n</code></pre> Skip a whole module:</p> <pre><code>import pytest\npytest.skip(\"skipping test file\", allow_module_level=True)\n</code></pre> <p>Show skip reasons / info:</p> <pre><code>py.test -rs\n</code></pre> <p>Advanced: https://pytest.org/latest/skipping.html</p>"},{"location":"pytest/pytest_cheat_sheet/#test_using_parametrize","title":"Test using parametrize","text":"<pre><code>import pytest\n\n@pytest.mark.parametrize(\n   ('n', 'expected'), [\n       (1, 2),\n       (2, 3),\n       (3, 4),\n       (4, 5),\n       pytest.mark.xfail((1, 0)),\n       pytest.mark.xfail(reason=\"some bug\")((1, 0)),\n       pytest.mark.skipif('sys.version_info &gt;= (3,0)')((10, 11)),\n   ]\n)\ndef test_increment(n, expected):\n   assert n + 1 == expected\n</code></pre>"},{"location":"pytest/pytest_cheat_sheet/#configuration","title":"Configuration","text":"<p>See https://docs.pytest.org/en/latest/customize.html</p> <p>Check if there are unexpected pytest.ini, tox.ini or setup.cfg somewhere in the project.</p>"},{"location":"pytest/pytest_cheat_sheet/#known_issues","title":"Known issues","text":""},{"location":"pytest/pytest_cheat_sheet/#assert_error_with_python_35","title":"assert error with python 3.5","text":"<p><code>TypeError: Call constructor takes either 0 or 3 positional arguments</code></p> <p>Workaround: add the parameter <code>--assert=plain</code> to the pytest command</p>"},{"location":"pytest/pytest_cheat_sheet/#pytestini","title":"pytest.ini","text":"<p>Put a section marker at the top:</p> <pre><code>[pytest]\n</code></pre>"},{"location":"pytest/pytest_cheat_sheet/#line_continuation","title":"Line continuation","text":"<p>indent continued line by 2 spaces:*</p> <pre><code>norecursedirs = \n  .git\n  .idea\n</code></pre>"},{"location":"pytest/pytest_cheat_sheet/#norecursedir","title":"norecursedir","text":"<p>Allows only simple directory names or patterns wihtout <code>/</code>, they are always applied in all subdirectories. For individual directories use: 'addopts --ignore='!</p>"},{"location":"pytest/pytest_cheat_sheet/#addopts","title":"addopts","text":"<p>Example:</p> <p>addopts =    --ignore=./some/dir   --ignore=./some/other/dir   --ignore=./dir1/some.file</p>"},{"location":"pytest/pytest_cheat_sheet/#helper_to_write_dict_to_tmpdatajson","title":"Helper to write dict to /tmp/data.json","text":"<pre><code>def dump1(data, fname=\"/tmp/data.json\"):\n    from json import JSONEncoder\n    class DateTimeAndDecimalEncoder(JSONEncoder):\n        def default(self, obj):\n          import datetime\n          import decimal\n          if isinstance(obj, datetime.datetime):\n            encoded_object = obj.isoformat()\n            # e.g. \"2014-06-22T04:44:14.057000\"\n          elif isinstance(obj, decimal.Decimal):\n            return str(obj)\n          else:\n            encoded_object =JSONEncoder.default(self, obj)\n          return encoded_object\n\n    def dumps_pretty(s):\n        # datetime.datetime(2013, 9, 13, 9, 59, 11) is not JSON serializable\n        import json\n        return\"%s\" % json.dumps(s,\n          sort_keys=True,\n          indent=2,\n          separators=(',', ': '),\n          cls=DateTimeAndDecimalEncoder,\n        )  \n\n    f = open(fname, \"w\")\n    f.write(dumps_pretty(data))\n    f.close()\n</code></pre>"},{"location":"pytest/pytest_docker/","title":"PyTest and Docker","text":"<p>Docker seems to be an essential part of testing work.</p> <p>As a result, I have a section on Docker, with a sub section of Docker To Go, a range of ready made Docker set ups: Docker</p> <p>I have done many trainings on Docker and I would say the best training is on my favourite platform Udemy: Docker Bootcamp: Conquer Docker with Real-World Projects</p> <p>Sales every two weeks or so will mean you can get if for $20 USD or so. </p> <p>What I really like about this course is it does not really go into theory but just builds a great number of microservices and connects them. Repetition makes it become part of the muscle and is probably what is needed for a Test Engineer.</p> <p>There are other courses that go deeper and one that I find really good is: Python in Containers</p>"},{"location":"pytest/pytest_docker/#docker_and_pytest_full_stack","title":"Docker and PyTest Full Stack","text":"<p>PyTest-Full-Stack has one example using <code>pytest-docker</code>.</p> <p>Ensure docker desktop or equivalent is running! \ud83d\ude2c </p> <p>Located in tests/docker. My usual folder naming of 70_docker is unacceptable so I just use docker.</p> <p>There is a YT video of this: pytest-docker</p>"},{"location":"pytest/pytest_docker/#docker_and_pytest","title":"Docker and PyTest","text":"<p>There are a number of subjects covered in Toolbox &gt; Docker. The section is here</p>"},{"location":"pytest/pytest_docker/#other_plugins","title":"Other plugins","text":"<p>There are a number of docker plugins for pytest:</p> <ul> <li><code>pytest-docker-compose</code></li> <li><code>pytest-docker-tools</code></li> <li><code>docker-python-unittest-pytest</code> is a more DIY setup.</li> </ul>"},{"location":"pytest/pytest_docker/#docker-postgres-pgadmin-adminer_-_to_go","title":"Docker-Postgres-PGAdmin-Adminer - to go","text":"<p>I have a YT video and repo that I have tested many times myself. It also uses my custom Postgres image which has PGVector extension added for Semantic Search, (AI RAG).</p> <p></p>"},{"location":"pytest/pytest_full_stack_customise/","title":"How to configure your own custom PyTest Full Stack","text":""},{"location":"pytest/pytest_full_stack_customise/#please_see_the_videos_in_the_playlist","title":"Please see the videos in the playlist","text":"<p>YouTube playlist: here</p> <p>This covers:</p> <ul> <li>pytest.ini settings for logging.</li> <li>how to read values from the config.ini files in the config folder.</li> <li>customise the report header in the console output.</li> <li>customising the test status words, colours and icons in the console output.</li> <li>adding a report section at end of console output.</li> <li>and more...</li> </ul> <p></p>"},{"location":"pytest/pytest_test_management/","title":"Test Management","text":""},{"location":"pytest/pytest_test_management/#using_the_test_name_as_meta_data","title":"Using the test name as meta data","text":"<p>If we name our tests with the following structure:</p> <p>test_0001_api_description</p> <p>We can programatically use the pytest_collection_modifyitems(items), where items is a list of tests, to extract out the following information:</p> <ul> <li>test id (0001).</li> <li>type of test, (api), which could be any 3 character code like dbm for database model, int for integrations, unt for unit etc</li> <li>we also get access to the nodeid and markers for each test with this hook.</li> </ul> <p>This can be loaded into a database and then combined with the output CSVs that have:</p> <ul> <li>test id</li> <li>test name</li> <li>any markers</li> <li>test node id which gives folder, parent folders up to tests folder</li> <li>test result</li> <li>test duration</li> </ul> <p>Docstrings can also be extracted and added to the database.</p>"},{"location":"pytest/pytest_test_management/#report_name_as_test_run_information","title":"Report name as test run information","text":"<p>Furthermore, as output test CSV files have the format of <code>report_2024-06-02-13-39-00_9496487.csv</code>, we can split the filename on '_'. giving us the date and time of the test  from the second item. This should be globally unique as it gives the time to the second, but to ensure global uniqueness, a randon intger between, 1_000_000 and 9_999_999 is added.</p> <p>This enable these data tables to be joined to create detailed test reporting. A sprint version number can also be added to create a history of tests by sprint.</p> <p>Extending the database with test creators, creation date, test modifier and modification date, we can create audit trails of tests.</p> <p></p>"},{"location":"pytest/pytest_tests/","title":"Tests","text":""},{"location":"pytest/pytest_tests/#00_check_setup","title":"00 check_setup","text":"<p>These are used to test that:</p> <ul> <li>src and tests are wired correctly</li> <li>read config.ini in the config folder</li> <li>logging works and outputs to log/pytesting.log</li> <li>test a sample mock works</li> </ul>"},{"location":"pytest/pytest_tests/#01_inspect","title":"01 Inspect","text":"<p>Using SQLModel's inspect, we run tests on SQL schema to verify foreign keys, check constraints etc exist. Inspired by Very Academy's TDD Fast Api course.</p>"},{"location":"pytest/pytest_tests/#02_coffeebeforearch","title":"02 CoffeeBeforeArch","text":"<p>Located in <code>02_py_coffee</code> in PFS, this is a great video series on PyTest. I have included the tests form his repo as part of the template tests. Links in repo.</p> <p>CoffeeBeforeArch</p>"},{"location":"pytest/pytest_tests/#03_indian_pythonista","title":"03 Indian Pythonista","text":"<p>Located in <code>03_indian_pythonista</code> in PFS, this is another great video series that has source code included.</p> <p>Indian Pythonista</p>"},{"location":"pytest/pytest_tests/#05_mocks_patch","title":"05 mocks_patch","text":"<p>A large number of templated mocks and patches, with extensive code comments. I have adapted them as necessary and the links to the YouTube videos are included.</p> <p>Some did not have source code so I transcribed the code from the videos.</p>"},{"location":"pytest/pytest_tests/#10_py_api_pets","title":"10 py_api_pets","text":"<p>Using Playwright, the full CRUD api tests to https://petstore.swagger.io/v2/pet/ is included providing templates for API testing.</p>"},{"location":"pytest/pytest_tests/#20_playwright","title":"20 playwright","text":"<p>A great range of End2End tests from a variety of sources.</p>"},{"location":"pytest/pytest_tests/#50_pwe_bdd","title":"50 pwe_bdd","text":"<p>A working example of using the pyTest-bdd, based on the awesome resource https://pytest-with-eric.com/ which is perhaps the best resource on PyTest available.</p>"},{"location":"pytest/pytest_tests/#60_pwe","title":"60 pwe","text":"<p>Using the awesome resource https://pytest-with-eric.com/, I have started to create videos of me working through Eric's articles and integrating them into PFS.</p>"},{"location":"pytest/pytest_tests/#docker","title":"Docker","text":"<p>These are tests that use/test Docker implementations. Alas, my favoured numbering system was not possible due to erroring, but is section 70.</p> <p></p>"},{"location":"toolbox/allure_windows_setup/","title":"Allure Reporting - Windows","text":"<p>If you are on Windows, like me, we can set up Allure as follows:</p> <p>I used the following video as learning:</p> <p>Useful JDK Video</p> <p>I created my own video here:</p> <p>Install JDK</p> <p>To install Allure: </p> <p>Allure Install</p> <ul> <li>For Allure, download the zip of the version you want.</li> <li>Unzip and place in a location of your choice.</li> <li>Add the path in environment variables. Mine was C:\\allure\\bin</li> </ul> <p></p>"},{"location":"toolbox/pytest_pydantic/","title":"Pydantic Utilities","text":"<p>I have a number of utilities based on Pydantic that can be of use.</p> <p>The idea I am working on is using generators with Pydantic to provide test data to use in the <code>pytest_generate_tests</code> hook so that we can decouple large and dynamic test data from PyTest and use Python to load in data dynamically and configured from some sort of config file.</p> <p>These will be added to the toolbox in due course...</p>"},{"location":"toolbox/python_on_whales/","title":"Python on Whales","text":"<p>Docs: Python on Whales</p> <ul> <li>1 to 1 mapping between the CLI interface and the Python API. No need to look in the docs what is the name of the function/argument you need.</li> <li>Docker object as Python objects: Container, Images, Volumes, Services... and their attributes are updated in real-time!</li> <li>Each Docker object can be used as a context manager. When getting out of the context, the Docker object is removed automatically, even if an exception occurs.</li> <li>In a sense this project is built on top of Docker-py because the implementation, the organisation and the API is inspired from the project, but the codebases could not be the same.</li> <li><pre><code>docker run --name some-postgres -e POSTGRES_PASSWORD=mysecretpassword -d postgres\n</code></pre> becomes <pre><code>from python_on_whales import docker\n\ndocker.run(\n    \"postgres:9.6\",\n    name=\"some-postgres\",\n    envs={\"POSTGRES_PASSWORD\": \"mysecretpassword\"},\n    detach=True,\n)\nprint(docker.ps())\n# [python_on_whales.Container(id='f5fb939c409d', name='some-postgres')]\n</code></pre></li> </ul> <p>We have seen in other Docker examples the use of ARG: <pre><code>ARG BaseImage\nFROM $BaseImage\n</code></pre> and this means we can use this and other shell variables to script a lot of processes and create our own testing matrix.</p> <p>Some uses to follow...</p> <p></p>"},{"location":"toolbox/toolbox_index/","title":"Toolbox","text":"<p>This is a colelction of resources that are of use as a Python Test Engineer but are not part of PyTest Full Stack. </p> <p>They are self-contained units.</p> <p>Docker plays are a large part in the Toolbox and may end up having its own dedicated section.</p>"}]}